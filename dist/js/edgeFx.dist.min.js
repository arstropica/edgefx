/*! edgeFx 2015-03-29 */
!function(){function a(a){for(var b=0,c=0;;){if(a(b,c))return[b,c];0===b?(b=c+1,c=0):(b-=1,c+=1)}}function b(a,b,c,d){var e,f,g,h,i,j,k;return e=d[a],f=e[0],g=e[1],e=d[b],h=e[0],i=e[1],e=d[c],j=e[0],k=e[1],(k-g)*(h-f)-(i-g)*(j-f)>0}function c(a,b,c){return(c[0]-b[0])*(a[1]-b[1])<(c[1]-b[1])*(a[0]-b[0])}function d(a,b,c,d){var e=a[0],f=b[0],g=c[0],h=d[0],i=a[1],j=b[1],k=c[1],l=d[1],m=e-g,n=f-e,o=h-g,p=i-k,q=j-i,r=l-k,s=(o*p-r*m)/(r*n-o*q);return[e+s*n,i+s*q]}function e(a,b){var c={list:a.map(function(a,b){return{index:b,x:a[0],y:a[1]}}).sort(function(a,b){return a.y<b.y?-1:a.y>b.y?1:a.x<b.x?-1:a.x>b.x?1:0}),bottomSite:null},d={list:[],leftEnd:null,rightEnd:null,init:function(){d.leftEnd=d.createHalfEdge(null,"l"),d.rightEnd=d.createHalfEdge(null,"l"),d.leftEnd.r=d.rightEnd,d.rightEnd.l=d.leftEnd,d.list.unshift(d.leftEnd,d.rightEnd)},createHalfEdge:function(a,b){return{edge:a,side:b,vertex:null,l:null,r:null}},insert:function(a,b){b.l=a,b.r=a.r,a.r.l=b,a.r=b},leftBound:function(a){var b=d.leftEnd;do b=b.r;while(b!=d.rightEnd&&e.rightOf(b,a));return b=b.l},del:function(a){a.l.r=a.r,a.r.l=a.l,a.edge=null},right:function(a){return a.r},left:function(a){return a.l},leftRegion:function(a){return null==a.edge?c.bottomSite:a.edge.region[a.side]},rightRegion:function(a){return null==a.edge?c.bottomSite:a.edge.region[k[a.side]]}},e={bisect:function(a,b){var c={region:{l:a,r:b},ep:{l:null,r:null}},d=b.x-a.x,e=b.y-a.y,f=d>0?d:-d,g=e>0?e:-e;return c.c=a.x*d+a.y*e+.5*(d*d+e*e),f>g?(c.a=1,c.b=e/d,c.c/=d):(c.b=1,c.a=d/e,c.c/=e),c},intersect:function(a,b){var c=a.edge,d=b.edge;if(!c||!d||c.region.r==d.region.r)return null;var e=c.a*d.b-c.b*d.a;if(Math.abs(e)<1e-10)return null;var f,g,h=(c.c*d.b-d.c*c.b)/e,i=(d.c*c.a-c.c*d.a)/e,j=c.region.r,k=d.region.r;j.y<k.y||j.y==k.y&&j.x<k.x?(f=a,g=c):(f=b,g=d);var l=h>=g.region.r.x;return l&&"l"===f.side||!l&&"r"===f.side?null:{x:h,y:i}},rightOf:function(a,b){var c=a.edge,d=c.region.r,e=b.x>d.x;if(e&&"l"===a.side)return 1;if(!e&&"r"===a.side)return 0;if(1===c.a){var f=b.y-d.y,g=b.x-d.x,h=0,i=0;if(!e&&c.b<0||e&&c.b>=0?i=h=f>=c.b*g:(i=b.x+b.y*c.b>c.c,c.b<0&&(i=!i),i||(h=1)),!h){var j=d.x-c.region.l.x;i=c.b*(g*g-f*f)<j*f*(1+2*g/j+c.b*c.b),c.b<0&&(i=!i)}}else{var k=c.c-c.a*b.x,l=b.y-k,m=b.x-d.x,n=k-d.y;i=l*l>m*m+n*n}return"l"===a.side?i:!i},endPoint:function(a,c,d){a.ep[c]=d,a.ep[k[c]]&&b(a)},distance:function(a,b){var c=a.x-b.x,d=a.y-b.y;return Math.sqrt(c*c+d*d)}},f={list:[],insert:function(a,b,c){a.vertex=b,a.ystar=b.y+c;for(var d=0,e=f.list,g=e.length;g>d;d++){var h=e[d];if(!(a.ystar>h.ystar||a.ystar==h.ystar&&b.x>h.vertex.x))break}e.splice(d,0,a)},del:function(a){for(var b=0,c=f.list,d=c.length;d>b&&c[b]!=a;++b);c.splice(b,1)},empty:function(){return 0===f.list.length},nextEvent:function(a){for(var b=0,c=f.list,d=c.length;d>b;++b)if(c[b]==a)return c[b+1];return null},min:function(){var a=f.list[0];return{x:a.vertex.x,y:a.ystar}},extractMin:function(){return f.list.shift()}};d.init(),c.bottomSite=c.list.shift();for(var g,h,i,j,l,m,n,o,p,q,r,s,t,u=c.list.shift();;)if(f.empty()||(g=f.min()),u&&(f.empty()||u.y<g.y||u.y==g.y&&u.x<g.x))h=d.leftBound(u),i=d.right(h),n=d.rightRegion(h),s=e.bisect(n,u),m=d.createHalfEdge(s,"l"),d.insert(h,m),q=e.intersect(h,m),q&&(f.del(h),f.insert(h,q,e.distance(q,u))),h=m,m=d.createHalfEdge(s,"r"),d.insert(h,m),q=e.intersect(m,i),q&&f.insert(m,q,e.distance(q,u)),u=c.list.shift();else{if(f.empty())break;h=f.extractMin(),j=d.left(h),i=d.right(h),l=d.right(i),n=d.leftRegion(h),o=d.rightRegion(i),r=h.vertex,e.endPoint(h.edge,h.side,r),e.endPoint(i.edge,i.side,r),d.del(h),f.del(i),d.del(i),t="l",n.y>o.y&&(p=n,n=o,o=p,t="r"),s=e.bisect(n,o),m=d.createHalfEdge(s,t),d.insert(j,m),e.endPoint(s,k[t],r),q=e.intersect(j,m),q&&(f.del(j),f.insert(j,q,e.distance(q,n))),q=e.intersect(m,l),q&&f.insert(m,q,e.distance(q,n))}for(h=d.right(d.leftEnd);h!=d.rightEnd;h=d.right(h))b(h.edge)}function f(){return{leaf:!0,nodes:[],point:null}}function g(a,b,c,d,e,f){if(!a(b,c,d,e,f)){var h=.5*(c+e),i=.5*(d+f),j=b.nodes;j[0]&&g(a,j[0],c,d,h,i),j[1]&&g(a,j[1],h,d,e,i),j[2]&&g(a,j[2],c,i,h,f),j[3]&&g(a,j[3],h,i,e,f)}}function h(a){return{x:a[0],y:a[1]}}d3.geom={},d3.geom.contour=function(b,c){var d=c||a(b),e=[],f=d[0],g=d[1],h=0,k=0,l=0/0,m=0/0,n=0;do n=0,b(f-1,g-1)&&(n+=1),b(f,g-1)&&(n+=2),b(f-1,g)&&(n+=4),b(f,g)&&(n+=8),6===n?(h=-1===m?-1:1,k=0):9===n?(h=0,k=1===l?-1:1):(h=i[n],k=j[n]),h!=l&&k!=m&&(e.push([f,g]),l=h,m=k),f+=h,g+=k;while(d[0]!=f||d[1]!=g);return e};var i=[1,0,1,1,-1,0,-1,1,0,0,0,0,-1,0,-1,0/0],j=[0,-1,0,0,0,-1,0,0,1,-1,1,1,0,-1,0,0/0];d3.geom.hull=function(a){if(a.length<3)return[];var c,d,e,f,g,h,i,j,k,l,m=a.length,n=m-1,o=[],p=[],q=0;for(c=1;m>c;++c)a[c][1]<a[q][1]?q=c:a[c][1]==a[q][1]&&(q=a[c][0]<a[q][0]?c:q);for(c=0;m>c;++c)c!==q&&(f=a[c][1]-a[q][1],e=a[c][0]-a[q][0],o.push({angle:Math.atan2(f,e),index:c}));for(o.sort(function(a,b){return a.angle-b.angle}),k=o[0].angle,j=o[0].index,i=0,c=1;n>c;++c)d=o[c].index,k==o[c].angle?(e=a[j][0]-a[q][0],f=a[j][1]-a[q][1],g=a[d][0]-a[q][0],h=a[d][1]-a[q][1],e*e+f*f>=g*g+h*h?o[c].index=-1:(o[i].index=-1,k=o[c].angle,i=c,j=d)):(k=o[c].angle,i=c,j=d);for(p.push(q),c=0,d=0;2>c;++d)-1!==o[d].index&&(p.push(o[d].index),c++);for(l=p.length;n>d;++d)if(-1!==o[d].index){for(;!b(p[l-2],p[l-1],o[d].index,a);)--l;p[l++]=o[d].index}var r=[];for(c=0;l>c;++c)r.push(a[p[c]]);return r},d3.geom.polygon=function(a){return a.area=function(){for(var b=0,c=a.length,d=a[c-1][0]*a[0][1],e=a[c-1][1]*a[0][0];++b<c;)d+=a[b-1][0]*a[b][1],e+=a[b-1][1]*a[b][0];return.5*(e-d)},a.centroid=function(b){var c,d,e,f=-1,g=a.length-1,h=0,i=0;for(arguments.length||(b=-1/(6*a.area()));++f<g;)c=a[f],d=a[f+1],e=c[0]*d[1]-d[0]*c[1],h+=(c[0]+d[0])*e,i+=(c[1]+d[1])*e;return[h*b,i*b]},a.clip=function(b){for(var e,f,g,h,i,j,k=-1,l=a.length,m=a[l-1];++k<l;){for(e=b.slice(),b.length=0,h=a[k],i=e[(g=e.length)-1],f=-1;++f<g;)j=e[f],c(j,m,h)?(c(i,m,h)||b.push(d(i,j,m,h)),b.push(j)):c(i,m,h)&&b.push(d(i,j,m,h)),i=j;m=h}return b},a},d3.geom.voronoi=function(a){var b=a.map(function(){return[]});return e(a,function(a){var c,d,e,f,g,h;1===a.a&&a.b>=0?(c=a.ep.r,d=a.ep.l):(c=a.ep.l,d=a.ep.r),1===a.a?(g=c?c.y:-1e6,e=a.c-a.b*g,h=d?d.y:1e6,f=a.c-a.b*h):(e=c?c.x:-1e6,g=a.c-a.a*e,f=d?d.x:1e6,h=a.c-a.a*f);var i=[e,g],j=[f,h];b[a.region.l.index].push(i,j),b[a.region.r.index].push(i,j)}),b.map(function(b,c){var d=a[c][0],e=a[c][1];return b.forEach(function(a){a.angle=Math.atan2(a[0]-d,a[1]-e)}),b.sort(function(a,b){return a.angle-b.angle}).filter(function(a,c){return!c||a.angle-b[c-1].angle>1e-10})})};var k={l:"r",r:"l"};d3.geom.delaunay=function(a){var b=a.map(function(){return[]}),c=[];return e(a,function(c){b[c.region.l.index].push(a[c.region.r.index])}),b.forEach(function(b,d){var e=a[d],f=e[0],g=e[1];b.forEach(function(a){a.angle=Math.atan2(a[0]-f,a[1]-g)}),b.sort(function(a,b){return a.angle-b.angle});for(var h=0,i=b.length-1;i>h;h++)c.push([e,b[h],b[h+1]])}),c},d3.geom.quadtree=function(a,b,c,d,e){function i(a,b,c,d,e,f){if(!isNaN(b.x)&&!isNaN(b.y))if(a.leaf){var g=a.point;g?Math.abs(g.x-b.x)+Math.abs(g.y-b.y)<.01?j(a,b,c,d,e,f):(a.point=null,j(a,g,c,d,e,f),j(a,b,c,d,e,f)):a.point=b}else j(a,b,c,d,e,f)}function j(a,b,c,d,e,g){var h=.5*(c+e),j=.5*(d+g),k=b.x>=h,l=b.y>=j,m=(l<<1)+k;a.leaf=!1,a=a.nodes[m]||(a.nodes[m]=f()),k?c=h:e=h,l?d=j:g=j,i(a,b,c,d,e,g)}var k,l=-1,m=a.length;if(m&&isNaN(a[0].x)&&(a=a.map(h)),arguments.length<5)if(3===arguments.length)e=d=c,c=b;else{for(b=c=1/0,d=e=-(1/0);++l<m;)k=a[l],k.x<b&&(b=k.x),k.y<c&&(c=k.y),k.x>d&&(d=k.x),k.y>e&&(e=k.y);var n=d-b,o=e-c;n>o?e=c+n:d=b+o}var p=f();return p.add=function(a){i(p,a,b,c,d,e)},p.visit=function(a){g(a,p,b,c,d,e)},a.forEach(p.add),p},"function"==typeof define&&define.amd?define(d3.geom):"object"==typeof module&&module.exports&&(module.exports=d3.geom)}(),!function(){function a(a){function d(){for(;h=k<j.length&&a>l;){var b=k++,d=j[b],f=c.call(d,1);f.push(e(b)),++l,d[0].apply(null,f)}}function e(a){return function(b,c){--l,null==n&&(null!=b?(n=b,k=m=0/0,f()):(j[a]=c,--m?h||d():f()))}}function f(){null!=n?o(n):i?o(n,j):o.apply(null,[n].concat(j))}var g,h,i,j=[],k=0,l=0,m=0,n=null,o=b;return a||(a=1/0),g={defer:function(){return n||(j.push(arguments),++m,d()),g},await:function(a){return o=a,i=!1,m||f(),g},awaitAll:function(a){return o=a,i=!0,m||f(),g}}}function b(){}var c=[].slice;a.version="1.0.7","function"==typeof define&&define.amd?define(function(){return a}):"object"==typeof module&&module.exports?module.exports=a:this.queue=a}(),function(a,b){if("object"==typeof exports){if("undefined"!=typeof module&&module.exports){var c=require("d3"),d=require("geom"),e=require("queue");module.exports=b(c,d,e)}}else if("function"==typeof define&&define.amd)define(["d3","geom","queue"],function(c,d,e){return a.edgeFx=b(c,d,e),a.edgeFx});else if(a.d3)if(a.d3.geom)if(a.queue)a.edgeFx=b(a.d3,a.d3.geom,a.queue);else{if(!console||!console.warn)throw"edgeFx requires queue to run.  Are you missing a reference to the queue library?";console.warn("edgeFx requires queue to run.  Are you missing a reference to the queue library?")}else{if(!console||!console.warn)throw"edgeFx requires geom to run.  Are you missing a reference to the geom library?";console.warn("edgeFx requires geom to run.  Are you missing a reference to the geom library?")}else{if(!console||!console.warn)throw"edgeFx requires d3 to run.  Are you missing a reference to the d3 library?";console.warn("edgeFx requires d3 to run.  Are you missing a reference to the d3 library?")}}(this,function(a,b,c){var d=new Date,e={version:"0.0.1",helpers:{},filters:{},defaults:{},draft:{methods:{},factory:{},state:{}},effects:{init:{},methods:{},factory:{}},plugins:{},animation:{queue:null,state:{},methods:{},factory:{}},events:{factory:{},methods:{}},opts:{}};if(e.defaults={presentation:{mode:"showcase",duration:3e3,delay:2e3},svg:{"class":"edgeSVG",root:"BODY",insert:!0,visibility:!0,path:{stroke:{color:"#000",width:2,opacity:"random","class":"edgeLine",pattern:"solid",visibility:!0},filter:{selector:null,features:["background","border","image"]},animation:{async:!1,delay:0,duration:1e3,tween:{type:"styleTween",property:"stroke-dashoffset",fn:function(b,c,d){{var e=a.select(this);e.node().getTotalLength()}return a.interpolate(d,String(0))}},repeat:{iterations:0,interval:"random"}}}},effects:{},plugins:{_default:function(a){this.events={ready:function(a,b){},init:function(a,b){},onload:function(a,b){},create:function(a,b){},queue:function(a,b){},animate:function(a,b){},complete:function(){}}}}},e.drafts=[],a.selection.prototype.appendData=function(a){this.datum(function(){return this.dataset});var b=this.data();"object"==typeof b&&b.length>0||(b=[]);for(prop in a)if(a.hasOwnProperty(prop)){var c=prop.camelCase(),d="object"==typeof a[prop]?e.helpers.toJSON(a[prop]):a[prop];b[0][c]=d}return this.data(b),this.datum(function(){return this.dataset}),this},a.selection.prototype.getData=function(a){a=a||!1;var b=this.data();return a?b&&b.length>0?"undefined"==typeof b[0][a]?!1:b[0][a]:!1:b},"function"!=typeof Object.defineProperty){var f=Object.defineProperty;Object.defineProperty=function(a,b,c){if(f)try{return f(a,b,c)}catch(d){}if(a!==Object(a))throw TypeError("Object.defineProperty called on non-object");return Object.prototype.__defineGetter__&&"get"in c&&Object.prototype.__defineGetter__.call(a,b,c.get),Object.prototype.__defineSetter__&&"set"in c&&Object.prototype.__defineSetter__.call(a,b,c.set),"value"in c&&(a[b]=c.value),a}}Object.defineProperty(String.prototype,"capitalize",{enumerable:!1,value:function(){return this.charAt(0).toUpperCase()+this.slice(1)}}),Object.defineProperty(String.prototype,"camelCase",{enumerable:!1,value:function(){return this.replace(/-([a-z])/gi,function(a,b){return b.toUpperCase()})}}),Object.defineProperty(Array.prototype,"clean",{enumerable:!1,value:function(a){a=a||void 0;for(var b=0;b<this.length;b++)(this[b]==a||""==this[b]||null===this[b])&&(this.splice(b,1),b--);return this}}),Object.defineProperty(Object.prototype,"getMethods",{enumerable:!1,value:function(){var a=[];for(var b in this)"function"==typeof this[b]&&a.push(b);return a}}),Object.defineProperty(Object.prototype,"isEmpty",{enumerable:!1,value:function(){for(var a in this)if(this.hasOwnProperty(a))return!1;return!0}}),Object.defineProperty(Object.prototype,"flatten",{enumerable:!1,value:function(a,b){var c,b;if("undefined"!=typeof this){a=a||"-",b=arguments.length>1&&arguments[1].length>0?arguments[1]+a:"",c=arguments.length>2?arguments[2]:{};for(var d in this)if(this.hasOwnProperty(d)){var e=b+d;if("object"==typeof this[d])if("[object Object]"==Object.prototype.toString.call(this[d])){var f=this[d].flatten(a,e,c);for(var g in f)f.hasOwnProperty(g)&&(c[g]=f[g])}else"undefined"!=typeof this[d]&&(c[e]=this[d]);else"undefined"!=typeof this[d]&&(c[e]=this[d])}}return c||{}}}),e.helpers.isJSON=function(a){try{JSON.parse(a)}catch(b){return!1}return!0},e.helpers.toJSON=function(a,b,c){function d(c,d){if(e.length>2e3)return"object too long";var g=!1;if(e.forEach(function(a,b){a===d&&(g=b)}),""==c)return e.push(a),f.push("root"),d;if(g+""!="false"&&"object"==typeof d)return"root"==f[g]?"(pointer to root)":"(see "+(d&&d.constructor?d.constructor.name.toLowerCase():typeof d)+" with key "+f[g]+")";var h=c||"(empty key)";return e.push(d),f.push(h),b?b(c,d):d}var e=[],f=[];return JSON.stringify(a,d,c)},e.helpers.isQuery=function(b,c){return c=c||!1,b&&b.hasOwnProperty&&b instanceof a.selection&&(c?b.node().nodeName==c:!0)},e.helpers.isString=function(a){return a&&"string"===$.type(a)},e.helpers.isNumeric=function(a){return!isNaN(parseFloat(a))&&isFinite(a)},e.helpers.isArray=function(a){return Array.isArray(a)},e.helpers.getStyle=function(a,b){return b=b||!1,a.currentStyle?b?a.currentStyle[b]:a.currentStyle:document.defaultView&&document.defaultView.getComputedStyle?b?document.defaultView.getComputedStyle(a,"")[b]:document.defaultView.getComputedStyle(a,""):b?a.style[b]:a.style},e.helpers.hasBorder=function(a){var b=window.getComputedStyle(a,null),c=["top","right","bottom","left"],d=0;d=Math.max(d,parseInt(b.getPropertyValue("border-width")));for(var e=0,f=c.length;f>e;e++)d=Math.max(d,parseInt(b.getPropertyValue("border-"+c[e]+"-width")));return d},e.helpers.hasBackground=function(a){var b=window.getComputedStyle(a,null),c=!1,d=["rgba(0, 0, 0, 0)","none"];props=["color","image"];for(var e=0,f=props.length;f>e;e++)c=c?c:d.indexOf(b.getPropertyValue("background-"+props[e]))<0;return c},e.helpers.getBorderRadius=function(a){var b=window.getComputedStyle(a,null),c=[null,"0px","0px 0px","0px 0px 0px 0px","0 0 0 0"];props={topright:["border-top-right-radius","-moz-border-radius-topright","-webkit-border-top-right-radius"],bottomright:["border-bottom-right-radius","-moz-border-radius-bottomright","-webkit-border-bottom-right-radius"],bottomleft:["border-bottom-left-radius","-moz-border-radius-bottomleft","-webkit-border-bottom-left-radius"],topleft:["border-top-left-radius","-moz-border-radius-topleft","-webkit-border-top-left-radius"]},result={topright:!1,bottomright:!1,bottomleft:!1,topleft:!1};for(bpos in props)for(var d=props[bpos],f=0,g=d.length;g>f;f++){var h=b.getPropertyValue(d[f]);result[bpos]=result[bpos]?result[bpos]:-1==e.helpers.searchStringInArray(h,c)?parseInt(h.replace("px","")):result[bpos]}return result},e.helpers.searchStringInArray=function(a,b){for(var c=0;c<b.length;c++)if(null===b[c]){if(null===a)return c}else if(b[c].match(a))return c;return-1},e.helpers.setAttributes=function(a,b){var c,d,e;e=[];for(c in b)d=b[c],"string"==typeof d?e.push(a.setAttribute(c,d)):a[c]=d;return e},e.helpers.nodeParents=function(a){for(var b=[],c=a.parentNode;c!==document;){var d=c;b.push(d),c=d.parentNode}return b},e.helpers.extend=function(){for(var a=1;a<arguments.length;a++)for(var b in arguments[a])arguments[a].hasOwnProperty(b)&&(arguments[a][b]&&arguments[a][b].constructor&&arguments[a][b].constructor===Object?(arguments[0][b]=arguments[0][b]||{},arguments.callee(arguments[0][b],arguments[a][b])):arguments[0][b]=arguments[a][b]);return arguments[0]},e.helpers.randomIntFromInterval=function(a,b){return Math.floor(Math.random()*(b-a+1)+a)},e.helpers.callfunc=function(a,b){var c=1===[].slice.call(arguments).splice(2).length?[].slice.call(arguments).splice(2)[0]:[].slice.call(arguments).splice(2);if("string"==typeof a){for(var d=a.split("."),e=d.pop(),f=0;f<d.length;f++)b=b[d[f]];return b[e].apply(b,c)}var e=a;return e.apply(b,c)},e.helpers.getOffsetSum=function(a){for(var b=0,c=0;a;)b+=parseInt(a.offsetTop),c+=parseInt(a.offsetLeft),a=a.offsetParent;return{top:b,left:c}},e.helpers.getOffset=function(a){return a.getBoundingClientRect?e.helpers.getOffsetRect(a):e.helpers.getOffsetSum(a)},e.helpers.getOffsetRect=function(a){var b=a.getBoundingClientRect(),c=document.body,d=document.documentElement,e=window.pageYOffset||d.scrollTop||c.scrollTop,f=window.pageXOffset||d.scrollLeft||c.scrollLeft,g=d.clientTop||c.clientTop||0,h=d.clientLeft||c.clientLeft||0,i=b.top+e-g,j=b.left+f-h;return{top:Math.round(i),left:Math.round(j)}},e.helpers.parseTString=function(a){var b={};if(a)for(var c in a=a.match(/(\w+\((\-?\d+\.?\d*e?\-?\d*,?)+\))+/g)){var d=a[c].match(/[\w\.\-]+/g);b[d.shift()]=d}return b},e.filters.filter=function(b,c){if(b=e.helpers.isQuery(b)?b:a.selectAll(b),b.empty())return b;if(c=c||{},0===Object.getOwnPropertyNames(c).length)b.attr("data-edgefx-filtered",1);else for(type in c){var d=c[type];if(d)switch(type){case"features":var f=e.helpers.isArray(d)?d:[d];f.forEach(function(a){switch(a){case"background":b.filter(e.filters.cssBackground).attr("data-edgefx-filtered",1);break;case"border":b.filter(e.filters.cssBorder).attr("data-edgefx-filtered",1);break;case"image":b.filter(e.filters.isImage).attr("data-edgefx-filtered",1)}});break;case"selector":b.select(d).attr("data-edgefx-filtered",1)}}return a.selectAll("[data-edgefx-filtered='1']")},e.filters.cssBackground=function(a,b){var c=!1,d=["rgba(0, 0, 0, 0)","none"];props=["color","image"];for(var f=0,g=props.length;g>f;f++){var h=e.helpers.getStyle(this,"background-"+props[f]);if(h)c=c?c:d.indexOf(h)<0;else if(window.getComputedStyle){var i=window.getComputedStyle(this,null);c=c?c:d.indexOf(i.getPropertyValue("background-"+props[f]))<0}}return c},e.filters.cssBorder=function(a,b){var c=["top","right","bottom","left"],d=0,f=e.helpers.getStyle(this);if(f)for(var g=0,h=c.length;h>g;g++)d=Math.max(d,parseInt(f["border-"+c[g]+"-width"]));else if(window.getComputedStyle)for(var i=window.getComputedStyle(this,null),g=0,h=c.length;h>g;g++)d=Math.max(d,parseInt(i.getPropertyValue("border-"+c[g]+"-width")));return d>0},e.filters.isImage=function(a,b){return"IMG"==this.nodeName},e.draft.factory=function(b){this.selection=null,this.selection=e.helpers.isQuery(b)?b:a.selectAll(b),this._svg=this._svg(),this._path=this._path()},e.draft.factory.svg=function(b,c){var d={};if(this.sourceOffset=[],this._svgRoot=e.helpers.isQuery(b)?b:a.select(b),this._svgRoot.empty())throw"The '"+b+"' root selector did not match any elements.  Please prefix with '#' to select by id or '.' to select by class";this.element=this._svgRoot.append("svg"),"undefined"!=typeof c.id&&this.element.attr("id",c.id),"undefined"!=typeof c.width&&this.element.attr("width",c.width),"undefined"!=typeof c.height&&this.element.attr("height",c.height),"undefined"!=typeof c["class"]&&this.element.classed(c["class"],!0),"undefined"!=typeof c.styles&&["top","left","position","height","width"].forEach(function(a,b){"undefined"!=typeof c.styles[a]&&(d[a]=c.styles[a])}),this.element.style(d),"undefined"!=typeof c.sourceOffset&&(this.sourceOffset=[e.opts.svg.path.stroke.width,e.opts.svg.path.stroke.width]),this.element.property("sourceOffset",this.sourceOffset)},e.draft.factory.path=function(b,c){var d,f,g,h,i,j,k,l,m,n,o;b.element=e.helpers.isQuery(b.element)?b.element:a.select(b.element),c=e.helpers.isQuery(c)?c:a.select(c),m=c.data(),d=c.node(),i=c.getData("edgefxStrokeClass")||e.opts.svg.path.stroke["class"],j=c.getData("edgefxStrokeColor")||e.opts.svg.path.stroke.color,k=c.getData("edgefxStrokeWidth")||e.opts.svg.path.stroke.width,h=c.getData("edgefxStrokeOpacity")||e.opts.svg.path.stroke.opacity,h=e.helpers.isNumeric(h)?h:e.helpers.randomIntFromInterval(10,90)/100,o=c.getData("edgefxStrokePattern")||e.opts.svg.path.stroke.pattern,l=b.element.property("sourceOffset");try{switch(d.nodeName){case"IMG":f=e.draft.methods.iPath(d,l);break;default:f=e.draft.methods.sPath(d,l)}}catch(p){return!1}g=b.element.append("path").attr("d",f),len=g.node().getTotalLength(),g.classed("path main "+i,!0),g.attr("id","edgePath_"+e.helpers.randomIntFromInterval(1e6,9999999)),g.attr("stroke",j),g.attr("stroke-width",k),g.attr("fill","none"),g.attr("stroke-dasharray",e.draft.methods.pattern2array(o,len)),g.attr("stroke-dashoffset",String(len)+"px"),g.style({opacity:h,stroke:j,"stroke-width":k,fill:"none"});var q="object"==typeof e.opts.svg.path.animation?e.opts.svg.path.animation.flatten("-","edgefx-anim"):!1;if(q&&"object"==typeof q&&!q.isEmpty()&&g.appendData(q),m.length>0){n=m[0];for(prop in n)prop.match(/^edgefx/i)&&"edgefxFiltered"!=prop&&g.attr("data-"+prop,n[prop])}switch(e.opts.presentation.mode){case"fadein":case"showcase":case"solo":default:c.style({visibility:"hidden",opacity:"0"}),g.style({visibility:"hidden"});break;case"inline":case"hidden":g.style({visibility:"hidden"})}c.classed({hassvg:!0}),this.element=g},e.draft.factory.prototype._svg=function(){var b,c,d,f,g,h,i,j,k,l,m;b=this.selection.node(),d={styles:{}},c={id:"edgeSVG_"+e.helpers.randomIntFromInterval(1e6,9999999),width:0,height:0,"class":"",sourceOffset:[0,0],styles:{top:0,left:0,width:0,height:0,position:"absolute"}};try{h=a.select(e.opts.svg.root)}catch(n){h=a.select("body")}return m=e.opts.svg["class"],f=b.getBoundingClientRect(),g=e.helpers.getOffset(b),j=parseInt(f.height)+2*e.opts.svg.path.stroke.width,i=parseInt(f.width)+2*e.opts.svg.path.stroke.width,k=g.top-e.opts.svg.path.stroke.width,l=g.left-e.opts.svg.path.stroke.width,d["class"]=m,d.width=i,d.height=j,d.sourceOffset=[e.opts.svg.path.stroke.width,e.opts.svg.path.stroke.width],d.styles.top=k+"px",d.styles.left=l+"px",d.styles.width=i+"px",d.styles.height=j+"px",d=e.helpers.extend({},c,d),new e.draft.factory.svg(h,d)},e.draft.factory.prototype._path=function(){return new e.draft.factory.path(this._svg,this.selection)},e.draft.factory.prototype.get=function(a){switch(a){case"svg":return this._svg.element;case"path":return this._path.element}return!1},e.draft.factory.prototype.getAttr=function(a,b){var c=this.get(a);return c?c.attr(b):!1},e.draft.methods.sPath=function(a,b){var c,d,f,g,h,i,j,k,l,m,n;c=a.getBoundingClientRect(),f=b[0],g=b[1],n=e.helpers.getBorderRadius(a),j=c.width,h=c.width,i=c.width,m=c.height,k=c.height,l=c.height;for(bpos in n)if(n[bpos])switch(bpos){case"topleft":k-=n[bpos],h-=n[bpos];break;case"bottomleft":k-=n[bpos],i-=n[bpos];break;case"bottomright":l-=n[bpos],i-=n[bpos];break;case"topright":l-=n[bpos],h-=n[bpos]}return d="M"+(f+n.topleft)+" "+g,n.topleft&&(d+=" A"+Number(1*n.topleft)+" "+Number(1*n.topleft)+" 0 0 0 "+f+" "+(g+Number(1*n.topleft))),d+=" L"+f+" "+(g+Number(1*n.topleft)+k),n.bottomleft&&(d+=" A"+Number(1*n.bottomleft)+" "+Number(1*n.bottomleft)+" 0 0 0 "+(f+Number(1*n.bottomleft))+" "+(g+m)),d+=" L"+(f+Number(1*n.bottomleft)+i)+" "+(g+m),n.bottomright&&(d+=" A"+Number(1*n.bottomright)+" "+Number(1*n.bottomright)+" 0 0 0 "+(f+j)+" "+(g+l+Number(1*n.bottomright))),d+=" L"+(f+j)+" "+(g+Number(1*n.topright)),n.topright&&(d+=" A"+Number(1*n.topright)+" "+Number(1*n.topright)+" 0 0 0 "+(f+j-Number(1*n.topright))+" "+g),d+=" L"+(f+Number(1*n.topleft))+" "+g,d+=" Z"},e.draft.methods.iPath=function(c,d){var f,g,h,i,j,k,l,m,n,o,p,q,r;if(b=a.geom||window.d3.geom,"undefined"==typeof b)throw"Could not find variable 'geom'.  Is the D3 countour plugin library installed?";r=e.helpers.nodeParents(c).shift().getBoundingClientRect(),f=c.getBoundingClientRect(),p=d[0],q=d[1],g=document.createElement("canvas"),i=g.width,j=g.height,k=g.getContext("2d"),k.drawImage(c,0,0,c.width,c.height),l=k.getImageData(0,0,i,j),m=l.data,n=function(a,b){var c=m[4*(b*i+a)+3];return c>20},h=b.contour(n),o="M"+(h[0][0]+p)+" "+(h[0][1]+q);for(var s=1;s<h.length;s++)o+=" L"+(h[s][0]+p)+" "+(h[s][1]+q);return o+=" Z"},e.draft.methods.pattern2array=function(a,b){a=a||e.opts.svg.path.stroke.pattern||"solid";var c=[];switch(a){case"solid":c.push(String(b)+"px",String(b)+"px");break;case"dashed":c.push("25px","25px");break;case"dotted":c.push("2px","25px");break;default:a.match(/,/i)?c=a.split(/[\s,]+/).splice(0,2).map(function(a){return a.replace(/^(\d+)$/i,"$1px")}):a.match(/[\s]*(\d+(?:px)?)[\s]+(\d+(?:px)?)/)?c=a.split(/[\s]+/).clean().splice(0,2).map(function(a){return a.replace(/^(\d+)$/i,"$1px")}):a.match(/[\s]*(\d+(?:px)?)[\s]*/)?c=[a,a].map(function(a){return a.replace(/^(\d+)$/i,"$1px")}):c.push(String(b)+"px",String(b)+"px")}return c.join(", ")},e.draft.methods.scale=function(b,c,d){var f;b=e.helpers.isQuery(b)?b:a.selectAll(b),c=c||!1,d=d||!1,c&&"undefined"!=typeof c.styles&&(["top","left","height","width"].forEach(function(a,d){"undefined"!=typeof c.styles[a]&&(f[a]=parseFloat(b.style(a))+parseFloat(c.styles[a])+"px")}),"undefined"!=typeof c.recenter&&c.recenter&&["height","width"].forEach(function(a,d){if("undefined"!=typeof c.styles[a])switch(a){case"height":f.top=parseFloat(b.style("top"))-parseFloat(c.styles.height)/2+"px";break;case"width":f.left=parseFloat(b.style("left"))-parseFloat(c.styles.width)/2+"px"}}),b.style(f),d&&c.recenter&&b.select(d).each(function(){var b={};["height","width"].forEach(function(d,e){if("undefined"!=typeof c.styles[d])switch(d){case"height":b.top=parseFloat(a.select(this).style("top"))-parseFloat(c.styles.height)/2+"px";break;case"width":b.left=parseFloat(a.select(this).style("left"))-parseFloat(c.styles.width)/2+"px"}}),a.select(this).style(b)}))},e.effects.factory=function(){},e.effects.init=function(){if(e.opts.effects){if("string"==typeof e.opts.effects){var a=new Object;a[e.opts.effects]=!0}else var a=e.opts.effects;if("[object Object]"==Object.prototype.toString.call(a))for(effect in a){var b=a[effect];if("undefined"!=typeof e.plugins[effect]){var c=new e.plugins[effect](b);if("[object Object]"==Object.prototype.toString.call(c.events))for(event in c.events)c.events.hasOwnProperty(event)&&"function"==typeof c.events[event]&&e.ev.addEvent(event,c.events[event],10)}}}},e.effects.methods.gclone=function(b,c,d){b=e.helpers.isQuery(b)?b:a.select(b),d=d||!1;for(var f=b.attr("id"),g=a.select(b.node().parentNode),h=g.append("g").attr("id",f+"_g").classed("cgroup",!0),i=0;c>i;i++){var j=b.property("nodeName"),k=b.node().attributes,l=k.length,m=h.append(j).attr("id",f+"_"+i);if(d)for(var n=0;l>n;n++)"id"!=k[n].nodeName&&m.attr(k[n].name,k[n].value);m.classed({clone:!0,main:!1})}return h},e.effects.factory.prototype.echo=function(b,c){b=e.helpers.isQuery(b,"path")?b:a.select(b);var d=e.helpers.isQuery(b.select("path.path.main"),"path")?b.select("path.path.main"):!1;if(d){var f="undefined"!=typeof c.paths?c.paths:5;f=e.helpers.isNumeric(f)?f:5;var g=e.helpers.getStyle(d.node(),"opacity"),h=.75*g/f,i=e.effects.methods.gclone(d,f);if(i&&e.helpers.isQuery(i)&&!i.empty()){i.attr("data-edgefxEffect","echo");var j=i.selectAll("path"),k=g-h;j.each(function(){a.select(this).attr("opacity",k).style("opacity",k),k-=h})}if("object"==typeof c&&c.hasOwnProperty)for(_setting in c)switch(_setting){case"animation":var l=c[_setting];l&&l.hasOwnProperty&&i.select("path").each(function(b,c){var d="anim";for(_key in l)a.select(this).attr("data-edgefx-"+d+"-"+_key,l[_key])})}return i}return!1},e.effects.factory.prototype.concentric=function(b,c){b=e.helpers.isQuery(b,"path")?b:a.select(b);var d=e.helpers.isQuery(b.select("path.path.main"),"path")?b.select("path.path.main"):!1;if(d){var f="undefined"!=typeof c.paths?c.paths:5;f=e.herlpers.isNumeric(f)?f:5;var g=e.effects.methods.gclone(d,f);if(g&&e.helpers.isQuery(g)&&!g.empty()&&g.attr("data-edgefxEffect","concentric"),"object"==typeof c&&c.hasOwnProperty)for(_setting in c)switch(_setting){case"edges":var h=e.helpers.isArray(c[_setting])?c[_setting]:[c[_setting]];h.length>=f&&g.select("path").each(function(b,c){var d=h[c];if("object"==typeof d&&d.hasOwnProperty)for(_prop in d)switch(_prop){case"stroke":var e=d[_prop];for(_key in e)switch(a.select(this).attr("data-edgefx-"+_prop+"-"+_key,e[_key]),_key){case"color":a.select(this).style("stroke",e[_key]),a.select(this).attr("stroke",e[_key]);break;case"width":a.select(this).style("stroke-width",e[_key]),a.select(this).attr("stroke-width",e[_key]);break;case"opacity":a.select(this).style("opacity",e[_key]),a.select(this).attr("opacity",e[_key]);break;case"class":a.select(this).classed(e[_key],!0)}}});break;case"animation":var i=c[_setting];i&&i.hasOwnProperty&&g.select("path").each(function(b,c){var d="anim";for(_key in i)a.select(this).attr("data-edgefx-"+d+"-"+_key,i[_key])})}return g}return!1},e.animation.factory=function(a){this.draft=a,e.ev.doEvent("queue",this,this.draft,e.animation.queue)},e.animation.methods.queue=function(a){this.queue=c(1),this.tasks=[],this.callback=a||function(){}},e.animation.methods.queue.prototype.add=function(a,b,c){a=a||function(a){a=a||!1,a&&a()},b=b||!0,c=c||0;var d=function(b,d){setTimeout(function(){a(d)},c)},e=this.tasks.length;if(0===e)this.tasks.push([d]);else switch(b){case"true":case!0:case 1:default:this.tasks[e-1].push(d);break;case"false":case 0:this.tasks.push([d])}},e.animation.methods.queue.prototype.start=function(a){a=a||0;var b=this.tasks,d=this.queue,f=this.callback;setTimeout(function(){b.forEach(function(a,b){if(e.helpers.isArray(a)){var f=function(d,e){e=e||!1;var f=c();a.forEach(function(a,b){f.defer(a,b)}),f.await(function(a){console.log("Completed sync task "+b),e&&e()})};d.defer(f,b)}else d.defer(a,b)}),d.awaitAll(function(a,b){f()})},a)},e.animation.methods.complete=function(){for(var b in e.draft.state)if(e.draft.state.hasOwnProperty(b)){var c=e.draft.state[b];switch(c._svg.element.style({"pointer-events":"none"}),e.opts.presentation.mode){case"showcase":default:a.select(e.opts.svg.root).style({visibility:"visible",opacity:"1.0"}),c.selection.style({opacity:"1.0",visibility:"visible"});break;case"fadein":case"inline":c.selection.style({opacity:"1.0",visibility:"visible"});break;case"solo":c._path.element.style({visibility:"visible"});break;case"hidden":}}console.log("edgeFx rendering in -> ",new Date-d,"ms")},e.events.factory=function(){this.events={}},e.events.factory.prototype.addEvent=function(a,b,c){return a=a||!1,b=b||!1,c=c||10,a&&b?("undefined"==typeof this.events[a]&&(this.events[a]={}),"undefined"==typeof this.events[a][c]&&(this.events[a][c]=new Array),this.events[a][c].push(b),!0):!1},e.events.factory.prototype.removeEvent=function(a,b,c){var d=-1;return a=a||!1,b=b||!1,c=c||!1,a&&b&&c!==!1&&"undefined"!=typeof this.events[a]&&"object"==typeof this.events[a][c]&&e.helpers.isArray(this.events[a][c])&&(this.events[a][c].forEach(function(a,c){a===b&&(d=c)}),d>=0)?(this.events[a][c].splice(d,1),!0):!1},e.events.factory.prototype.doEvent=function(a,b){a=a||!1,b=b||window;var c=[].slice.call(arguments).splice(2);if(a&&"undefined"!=typeof this.events[a]&&this.events[a].isEmpty()===!1)for(priority in this.events[a]){var d=this.events[a][priority];e.helpers.isArray(d)&&d.forEach(function(a){try{e.helpers.callfunc(a,b,c)}catch(d){console.log("Error Report Starts ---------------"),console.dir(c),console.dir(a),console.log(d.stack),console.log("Error Report Ends ---------------")}})}},e.events.factory.prototype.getHandlers=function(a){return a=a||!1,a&&"undefined"!=typeof this.events[a]?this.events[a]:!1},e.events.methods.ready=function(b,c){var f=setInterval(function(){if("complete"===document.readyState){console.log("DOM loaded in -> ",new Date-d,"ms"),clearInterval(f);var g=e.helpers.isQuery(b)?b:a.selectAll(b);switch(e.opts.presentation.mode){case"solo":case"fadein":case"showcase":default:a.select(e.opts.svg.root).style({
visibility:"hidden",opacity:"0"}),g.style({visibility:"hidden",opacity:"0"});break;case"inline":case"hidden":}e.ev.doEvent("ready",this,g,c)}},10)},e.events.methods.init=function(a,b){return this.selection=e.filters.filter(a,b.filter),this.options=b,e.ev.doEvent("init",this,this.selection,this.options),this.selection.empty()?void console.log("No nodes could be selected for edgeFx. Exiting..."):void 0},e.events.methods.onload=function(b,c){if(this.selection=a.selectAll("[data-edgefx-filtered='1']"),this.options=e.opts.svg,this.selection.empty())return!1;this.selection.datum(function(){return this.dataset});var d=this.options.flatten("-","edgefx-svg");this.selection.each(function(){var b=a.select(this).data();if(b.length>0)var c=e.helpers.extend({},d,b[0]);a.select(this).data(c)}),e.ev.doEvent("onload",this,this.selection,this.options)},e.events.methods.create=function(b,c){return this.selection=a.selectAll("[data-edgefx-filtered='1']"),this.options=e.opts.svg,this.selection.empty()?!1:(this.selection.classed("edgesrc",!0),this.selection.each(function(b,c){var d=new e.draft.factory(a.select(this));e.draft.state[c]=d,a.select(this).appendData({"edgefx-draft":c})}),void e.ev.doEvent("create",this,this.selection,this.options))},e.events.methods.queue=function(b,c){if(this.selection=a.selectAll("[data-edgefx-filtered='1'][data-edgefx-draft]"),this.options=e.opts.svg,this.selection.empty())return!1;switch(e.opts.presentation.mode){case"fadein":a.select(e.opts.svg.root).style({visibility:"visible"}).transition().duration(e.opts.presentation.duration).style("opacity","1.0");break;case"showcase":case"solo":default:a.select(e.opts.svg.root).style({visibility:"visible",opacity:"1.0"});break;case"inline":case"hidden":}this.selection.each(function(b,c){var d=a.select(this).data(),f=d[0].edgefxDraft,g=e.draft.state[f];e.animation.state[c]=new e.animation.factory(g)}),e.ev.doEvent("animate",this,this.selection,this.options)},e.events.methods.animate=function(a,b){e.animation.queue.start(e.opts.presentation.delay)},e.events.methods.complete=function(){e.ev.doEvent("complete",this)},a.edgeFx=function(a,b){var c;b=b||{},"undefined"==typeof b.effects&&(b.effects={"default":!0}),e.animation.queue=new e.animation.methods.queue(e.events.methods.complete),e.ev=new e.events.factory,e.opts=c=e.helpers.extend({},e.defaults,b),e.ev.addEvent("ready",e.effects.init,0),e.ev.addEvent("ready",e.events.methods.init,10),e.ev.addEvent("init",e.events.methods.onload,10),e.ev.addEvent("onload",e.events.methods.create,10),e.ev.addEvent("create",e.events.methods.queue,10),e.ev.addEvent("animate",e.events.methods.animate,10),e.ev.addEvent("complete",e.animation.methods.complete,10),e.events.methods.ready(a,c)},"function"==typeof define&&define.amd?define(e):"object"==typeof module&&module.exports&&(module.exports=e);return window.edgeFx=e,e}),"object"==typeof edgeFx&&(edgeFx.plugins["default"]=function(a){var b=this;this.events={ready:null,init:null,onload:null,create:null,queue:function(a,c){var d,e,f,g;d=a._path.element,g=a.selection,e=d.attr("data-edgefx-anim-async")||!0,f=d.attr("data-edgefx-anim-delay");var h=function(a){a=a||!1;var c=d.attr("data-edgefx-anim-interval")||0;c=edgeFx.helpers.isNumeric(c)?c:edgeFx.helpers.randomIntFromInterval(100,900);var e=d.attr("data-edgefx-anim-duration")||0;switch(edgeFx.opts.presentation.mode){case"showcase":case"fadein":case"solo":case"inline":default:d.style({visibility:"visible"});break;case"hidden":}d.transition().duration(e).ease("linear").styleTween("stroke-dashoffset",b.stroketween).each("end",function(){switch(edgeFx.opts.presentation.mode){case"showcase":g.style({opacity:"1.0",visibility:"visible"}),d.transition().duration(edgeFx.opts.presentation.duration).ease("linear").style({visibility:"hidden",opacity:"0"});break;case"inline":g.style({opacity:"1.0",visibility:"visible"});break;case"fadein":g.style({opacity:"0",visibility:"visible"}).transition().duration(edgeFx.opts.presentation.duration).ease("linear").styleTween("opacity",function(a,b,c){return d3.interpolate(c,String(1))}).each("end",function(){d.style({visibility:"hidden",opacity:"0"})});break;case"solo":case"hidden":}a&&setTimeout(a,c)})};c.add(h,e,f)},animate:null,complete:null},this.stroketween=function(a,b,c){{var d=d3.select(this);d.node().getTotalLength()}return d3.interpolate(c,String(0))}});